---
title: ECMAScript5.1-(9)类型转换
date: 2017-06-25 20:00:00
categories:
    - [技术, Javascript, ES5]
tags:
    - [Javascript]
---

## 9 概述

ECMAScript 运行时会按需自动进行类型转换。为了清楚地阐释规范中规范中的某些构造的语义，有必要定义一系列关于类型转换的抽象操作。这些抽象操作不是 EL 的一部分，它们只在规范中被定义，意义在于帮助解释规范中关于 EL 的一些操作。这些抽象操作只接受任意 EL 类型的值，不接受规范中的类型作为参数。

### 9.1 ToPrimitive

ToPrimitive 操作接受一个必输参数 input 和一个可选参数 PreferredType。它负责把 input 转化为非 Object 类型的值，也就是原始类型的值。如果 input 能够转化为多个原始类型，则使用 PreferredType 确定最后的转换值。转换规则如下表所示，[Table 10](http://ecma-international.org/ecma-262/5.1/#sec-9.1):

| Input Type | Result |
| --- | --- |
| Undefined | 不转换，直接返回 input |
| Null | 不转换，直接返回 input |
| Boolean | 不转换，直接返回 input |
| Number | 不转换，直接返回 input |
| String | 不转换，直接返回 input |
| Object | 返回 Object 类型的默认值。一个 object 的默认值的获取过程如下：调用该 object 的内置方法[[DefaultValue]]，并传入参数 PreferredType。[[DefaultValue]]的执行过程在规范[8.12.8](http://ecma-international.org/ecma-262/5.1/#sec-8.12.8)中定义。 |

### 9.2 ToBoolean

抽象操作会 ToBoolean 把参数转换为一个布尔类型的值。转换规则如下，[Table 11](http://ecma-international.org/ecma-262/5.1/#sec-9.2)：

| Argument Type | Result |
| --- | --- |
| Undefined | false |
| Null | false |
| Boolean | 不转换，直接返回 argument |
| Number | 如果 argument 为+0,-0,或 NaN 则返回 false；否则返回 true。 |
| String | 如果 argument 是空字符串(长度为 0)则返回 false；否则则返回 true。 |
| Object | true |

### 9.3 ToNumber

抽象操作 ToNumber 会把 argument 转换为 Number 类型的值。转换规则如下，[Table12](http://ecma-international.org/ecma-262/5.1/#sec-9.3)：

| Argument Type | Result |
| --- | --- |
| Undefined | NaN |
| Null | +0 |
| Boolean | 如果 argument 为 true 则返回 1；如果 argument 为 false 则返回+0。 |
| Number | 不转换，直接返回 argument。 |
| String | 符合数值形式的字符串转换为对应的数值；否则返回 NaN。 |
| Object | 1. 执行 ToPrimitive(argument, Number)，获取结果为 primValue。</br>2. 返回 ToNumber(primValue) |

### 9.8 ToString

抽象操作 ToString 会把参数 argument 转换为 String 类型的值。转换规则如下，[Table13](http://ecma-international.org/ecma-262/5.1/#sec-9.8)：

| Argument Type | Result |
| --- | --- |
| Undefined | "undefined" |
| Null | "null" |
| Boolean | 如果 argument 是 true 则返回“true“；如果 argument 是 false 则返回“false“。 |
| Number | 转换规则参考[ES 规范](http://ecma-international.org/ecma-262/5.1/#sec-9.8.1) |
| String | 不转换，直接返回 argument |
| Object | 1. 执行 ToPrimitive(argument, Number)，获取结果为 primValue。</br>2. 返回 ToString(primValue) |

### 9.9 ToObject

抽象操作 ToObject 会把 argument 转换为 Object 类型的值，转换规则如下表[Table 14](http://ecma-international.org/ecma-262/5.1/#sec-9.9)：

| Argument Type | Result |
| --- | --- |
| Null | 抛出 TypeError 异常 |
| Undefined | 抛出 TypeError 异常 |
| Boolean | 创建一个内置属性[[PrimitiveValue]]为 argument 的 object，该 object 的具体定义参考规范 |
| Number | 创建一个内置属性[[PrimitiveValue]]为 argument 的 object，该 object 的具体定义参考规范 |
| String | 创建一个内置属性[[PrimitiveValue]]为 argument 的 object，该 object 的具体定义参考规范 |
| Object | 不转换，直接返回 argument |

### 9.11 IsCallable

抽象操作 IsCallable 用来判断任一 EL 类型的值是否为可调用的函数对象。判断规则如下，[Table 16](http://ecma-international.org/ecma-262/5.1/#sec-9.11)：

| Argument Type | Result |
| --- | --- |
| Undefined | 返回 false |
| Null | 返回 false |
| Boolean | 返回 false |
| Number | 返回 false |
| String | 返回 false |
| Object | 如果 argument 有内置属性[[call]]，则返回 true，否则返回 false |

> Code Explanation

在全局环境中，ES 的内置的全局方法：Boolean，Number，String，Object，这些全局方法单纯作为函数被调用时，实际执行的就是上面的抽象操作。

```javascript
Boolean(123); // true 等同于ToBoolean(123)
Number('123'); // 123 等同于ToNumber('123')
String(123); // "123" 等同于ToString(123)
Object(123); // {...,[[PrimitiveValue:1]]} 等同于new
```

> Code Explanation End
