---
title: ECMAScript5.1-(9)类型转换
date: 2017-06-25 20:00:00
categories:
- [技术,Javascript,ES5]
tags:
- [Javascript]
---

## 9 概述

ECMAScript运行时会按需自动进行类型转换。为了清楚地阐释规范中规范中的某些构造的语义，有必要定义一系列关于类型转换的抽象操作。这些抽象操作不是EL的一部分，它们只在规范中被定义，意义在于帮助解释规范中关于EL的一些操作。这些抽象操作只接受任意EL类型的值，不接受规范中的类型作为参数。

### 9.1 ToPrimitive

ToPrimitive操作接受一个必输参数input和一个可选参数PreferredType。它负责把input转化为非Object类型的值，也就是原始类型的值。如果input能够转化为多个原始类型，则使用PreferredType确定最后的转换值。转换规则如下表所示，[Table 10](http://ecma-international.org/ecma-262/5.1/#sec-9.1):

Input Type|Result
-|-
Undefined|不转换，直接返回input
Null|不转换，直接返回input
Boolean|不转换，直接返回input
Number|不转换，直接返回input
String|不转换，直接返回input
Object|返回Object类型的默认值。一个object的默认值的获取过程如下：调用该object的内置方法[[DefaultValue]]，并传入参数PreferredType。[[DefaultValue]]的执行过程在规范[8.12.8](http://ecma-international.org/ecma-262/5.1/#sec-8.12.8)中定义。

### 9.2 ToBoolean

抽象操作会ToBoolean把参数转换为一个布尔类型的值。转换规则如下，[Table 11](http://ecma-international.org/ecma-262/5.1/#sec-9.2)：

Argument Type|Result
-|-
Undefined|false
Null|false
Boolean|不转换，直接返回argument
Number|如果argument为+0,-0,或NaN则返回false；否则返回true。
String|如果argument是空字符串(长度为0)则返回false；否则则返回true。
Object|true

### 9.3 ToNumber

抽象操作ToNumber会把argument转换为Number类型的值。转换规则如下，[Table12](http://ecma-international.org/ecma-262/5.1/#sec-9.3)：

Argument Type|Result
-|-
Undefined|NaN
Null|+0
Boolean|如果argument为true则返回1；如果argument为false则返回+0。
Number|不转换，直接返回argument。
String|符合数值形式的字符串转换为对应的数值；否则返回NaN。
Object|1. 执行ToPrimitive(argument, Number)，获取结果为primValue。</br>2. 返回 ToNumber(primValue)

### 9.8 ToString

抽象操作ToString会把参数argument转换为String类型的值。转换规则如下，[Table13](http://ecma-international.org/ecma-262/5.1/#sec-9.8)：

Argument Type|Result
-|-
Undefined|"undefined"
Null|"null"
Boolean|如果argument是true则返回“true“；如果argument是false则返回“false“。
Number|转换规则参考[ES规范](http://ecma-international.org/ecma-262/5.1/#sec-9.8.1)
String|不转换，直接返回argument
Object|1. 执行ToPrimitive(argument, Number)，获取结果为primValue。</br>2. 返回 ToString(primValue)

### 9.9 ToObject

抽象操作ToObject会把argument转换为Object类型的值，转换规则如下表[Table 14](http://ecma-international.org/ecma-262/5.1/#sec-9.9)：

Argument Type|Result
-|-
Null|抛出TypeError异常
Undefined|抛出TypeError异常
Boolean|创建一个内置属性[[PrimitiveValue]]为argument的object，该object的具体定义参考规范
Number|创建一个内置属性[[PrimitiveValue]]为argument的object，该object的具体定义参考规范
String|创建一个内置属性[[PrimitiveValue]]为argument的object，该object的具体定义参考规范
Object|不转换，直接返回argument

### 9.11 IsCallable

抽象操作IsCallable用来判断任一EL类型的值是否为可调用的函数对象。判断规则如下，[Table 16](http://ecma-international.org/ecma-262/5.1/#sec-9.11)：

Argument Type|Result
-|-
Undefined|返回false
Null|返回false
Boolean|返回false
Number|返回false
String|返回false
Object|如果argument有内置属性[[call]]，则返回true，否则返回false

>Code Explanation

在全局环境中，ES的内置的全局方法：Boolean，Number，String，Object，这些全局方法单纯作为函数被调用时，实际执行的就是上面的抽象操作。

```javascript
Boolean(123); // true 等同于ToBoolean(123)
Number('123'); // 123 等同于ToNumber('123')
String(123); // "123" 等同于ToString(123)
Object(123); // {...,[[PrimitiveValue:1]]} 等同于new
```

>Code Explanation End
